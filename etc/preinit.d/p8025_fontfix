fontFix(){
  if [ "$cfg_fontfix_enabled" == "y" ]; then
    local titleFontPath="$rootfs/usr/share/fonts/title.fnt"
    local copyrightFontPath="$rootfs/usr/share/fonts/copyright.fnt"
    local debugFontPath=""
    local sFontPath=""
    local mFontPath=""
    local lFontPath=""
    
    # Title Font
    [ -f "$installpath/fonts/title.fnt" ] && titleFontPath="$installpath/fonts/title.fnt"
    [ -f "$mountpoint/media/$modname/fonts/title.fnt" ] && titleFontPath="$mountpoint/media/$modname/fonts/title.fnt"
    
    # Copyright Font
    [ -f "$installpath/fonts/copyright.fnt" ] && copyrightFontPath="$installpath/fonts/copyright.fnt"
    [ -f "$mountpoint/media/$modname/fonts/copyright.fnt" ] && copyrightFontPath="$mountpoint/media/$modname/fonts/copyright.fnt"
    
    # Debug Font
    [ -f "$installpath/fonts/debug.fnt" ] && debugFontPath="$installpath/fonts/debug.fnt"
    [ -f "$mountpoint/media/$modname/fonts/debug.fnt" ] && debugFontPath="$mountpoint/media/$modname/fonts/debug.fnt"
    
    # Small Font
    [ -f "$installpath/fonts/small.fnt" ] && sFontPath="$installpath/fonts/small.fnt"
    [ -f "$mountpoint/media/$modname/fonts/small.fnt" ] && sFontPath="$mountpoint/media/$modname/fonts/small.fnt"
    
    # Medium Font
    [ -f "$installpath/fonts/medium.fnt" ] && mFontPath="$installpath/fonts/medium.fnt"
    [ -f "$mountpoint/media/$modname/fonts/medium.fnt" ] && mFontPath="$mountpoint/media/$modname/fonts/medium.fnt"
    
    # Large Font
    [ -f "$installpath/fonts/large.fnt" ] && lFontPath="$installpath/fonts/large.fnt"
    [ -f "$mountpoint/media/$modname/fonts/large.fnt" ] && lFontPath="$mountpoint/media/$modname/fonts/large.fnt"
    
    case "$sftype" in
      nes)
        local currentTitleFontHash="$(md5sum "$titleFontPath" | awk '{ print $1 }')"
        if [ -z "$cfg_fontfix_titlehash" ] || [ "$cfg_fontfix_titlehash" != "$currentTitleFontHash" ]; then
          [ -d "$rootfs$gamepath" ] && find "$rootfs$gamepath" -name "title.fnt" -exec rm {} \;
          cfg_fontfix_titlehash="$currentTitleFontHash"
        fi
        
        local currentCopyrightFontHash="$(md5sum "$copyrightFontPath" | awk '{ print $1 }')"
        if [ -z "$cfg_fontfix_copyrighthash" ] || [ "$cfg_fontfix_copyrighthash" != "$currentCopyrightFontHash" ]; then
          [ -d "$rootfs$gamepath" ] && find "$rootfs$gamepath" -name "title.fnt" -exec rm {} \;
          cfg_fontfix_copyrighthash="$currentCopyrightFontHash"
        fi
        
        # Title Font
        [ -d "$rootfs$gamepath" ] && copy "$titleFontPath" "$rootfs$gamepath"
        
        # Copyright Font
        [ -d "$rootfs$gamepath" ] && copy "$copyrightFontPath" "$rootfs$gamepath"
        
        # Debug Font
        [ -f "$debugFontPath" ] && [ -f "$mountpoint/usr/share/clover-ui/resources/fonts/debug.fnt" ] && \
          mount_bind "$debugFontPath" "$mountpoint/usr/share/clover-ui/resources/fonts/debug.fnt"
        
        # Small Font
        if [ -f "$sFontPath" ]; then
          [ -f "$mountpoint/usr/share/clover-ui/resources/fonts/nes/s.fnt" ] && \
            mount_bind "$sFontPath" "$mountpoint/usr/share/clover-ui/resources/fonts/nes/s.fnt"
          [ -f "$mountpoint/usr/share/clover-ui/resources/fonts/hvc/s.fnt" ] && \
            mount_bind "$sFontPath" "$mountpoint/usr/share/clover-ui/resources/fonts/hvc/s.fnt"
        fi
        
        # Medium Font
        if [ -f "$mFontPath" ]; then
          [ -f "$mountpoint/usr/share/clover-ui/resources/fonts/nes/m.fnt" ] && \
            mount_bind "$mFontPath" "$mountpoint/usr/share/clover-ui/resources/fonts/nes/m.fnt"
          [ -f "$mountpoint/usr/share/clover-ui/resources/fonts/hvc/m.fnt" ] && \
            mount_bind "$mFontPath" "$mountpoint/usr/share/clover-ui/resources/fonts/hvc/m.fnt"
        fi
        
        # Large Font
        if [ -f "$lFontPath" ]; then
          [ -f "$mountpoint/usr/share/clover-ui/resources/fonts/nes/l.fnt" ] && \
            mount_bind "$lFontPath" "$mountpoint/usr/share/clover-ui/resources/fonts/nes/l.fnt"
          [ -f "$mountpoint/usr/share/clover-ui/resources/fonts/hvc/l.fnt" ] && \
            mount_bind "$lFontPath" "$mountpoint/usr/share/clover-ui/resources/fonts/hvc/l.fnt"
        fi
        ;;
      snes)
        # Title Font
        if [ -f "$titleFontPath" ]; then
          [ -f "$mountpoint/usr/share/ui/snes-usa/resources/fonts/title.font" ] && \
            mount_bind "$titleFontPath" "$mountpoint/usr/share/ui/snes-usa/resources/fonts/title.font"
          [ -f "$mountpoint/usr/share/ui/snes-eur/resources/fonts/title.font" ] && \
            mount_bind "$titleFontPath" "$mountpoint/usr/share/ui/snes-eur/resources/fonts/title.font"
          [ -f "$mountpoint/usr/share/ui/shvc/resources/fonts/title.font" ] && \
            mount_bind "$titleFontPath" "$mountpoint/usr/share/ui/shvc/resources/fonts/title.font"
        fi
        
        # Copyright Font
        if [ -f "$copyrightFontPath" ]; then
          [ -f "$mountpoint/usr/share/ui/snes-usa/resources/fonts/copyright.fnt" ] && \
            mount_bind "$copyrightFontPath" "$mountpoint/usr/share/ui/snes-usa/resources/fonts/copyright.fnt"
          [ -f "$mountpoint/usr/share/ui/snes-eur/resources/fonts/copyright.fnt" ] && \
            mount_bind "$copyrightFontPath" "$mountpoint/usr/share/ui/snes-eur/resources/fonts/copyright.fnt"
          [ -f "$mountpoint/usr/share/ui/shvc/resources/fonts/copyright.fnt" ] && \
            mount_bind "$copyrightFontPath" "$mountpoint/usr/share/ui/shvc/resources/fonts/copyright.fnt"
        fi
        
        # Debug Font
        if [ -f "$debugFontPath" ]; then
          [ -f "$mountpoint/usr/share/ui/snes-usa/resources/fonts/debug.font" ] && \
            mount_bind "$debugFontPath" "$mountpoint/usr/share/ui/snes-usa/resources/fonts/debug.font"
          [ -f "$mountpoint/usr/share/ui/snes-eur/resources/fonts/debug.font" ] && \
            mount_bind "$debugFontPath" "$mountpoint/usr/share/ui/snes-eur/resources/fonts/debug.font"
          [ -f "$mountpoint/usr/share/ui/shvc/resources/fonts/debug.font" ] && \
            mount_bind "$debugFontPath" "$mountpoint/usr/share/ui/shvc/resources/fonts/debug.font"
        fi
        
        # Small Font
        if [ -f "$sFontPath" ]; then
          [ -f "$mountpoint/usr/share/ui/snes-usa/resources/fonts/s.font" ] && \
            mount_bind "$sFontPath" "$mountpoint/usr/share/ui/snes-usa/resources/fonts/s.font"
          [ -f "$mountpoint/usr/share/ui/snes-eur/resources/fonts/s.font" ] && \
            mount_bind "$sFontPath" "$mountpoint/usr/share/ui/snes-eur/resources/fonts/s.font"
          [ -f "$mountpoint/usr/share/ui/shvc/resources/fonts/s.fnt" ] && \
            mount_bind "$sFontPath" "$mountpoint/usr/share/ui/shvc/resources/fonts/s.fnt"
        fi
        
        # Medium Font
        if [ -f "$mFontPath" ]; then
          [ -f "$mountpoint/usr/share/ui/snes-usa/resources/fonts/m.font" ] && \
            mount_bind "$mFontPath" "$mountpoint/usr/share/ui/snes-usa/resources/fonts/m.font"
          [ -f "$mountpoint/usr/share/ui/snes-eur/resources/fonts/m.font" ] && \
            mount_bind "$mFontPath" "$mountpoint/usr/share/ui/snes-eur/resources/fonts/m.font"
          [ -f "$mountpoint/usr/share/ui/shvc/resources/fonts/m.fnt" ] && \
            mount_bind "$mFontPath" "$mountpoint/usr/share/ui/shvc/resources/fonts/m.fnt"
        fi
        
        # Large Font
        if [ -f "$lFontPath" ]; then
          [ -f "$mountpoint/usr/share/ui/snes-usa/resources/fonts/l.font" ] && \
            mount_bind "$lFontPath" "$mountpoint/usr/share/ui/snes-usa/resources/fonts/l.font"
          [ -f "$mountpoint/usr/share/ui/snes-eur/resources/fonts/l.font" ] && \
            mount_bind "$lFontPath" "$mountpoint/usr/share/ui/snes-eur/resources/fonts/l.font"
          [ -f "$mountpoint/usr/share/ui/shvc/resources/fonts/l.fnt" ] && \
            mount_bind "$lFontPath" "$mountpoint/usr/share/ui/shvc/resources/fonts/l.fnt"
        fi
        ;;
    esac
  else
    if [ "$sftype" == "nes" ] && [ -d "$rootfs$gamepath" ]; then
      find "$rootfs$gamepath" -name "*.fnt" -exec rm {} \;
      restore "$gamepath/title.fnt"
      restore "$gamepath/copyright.fnt"
    fi
  fi
}
fontFix
